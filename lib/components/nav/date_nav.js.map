{"version":3,"sources":["../../../src/components/nav/date_nav.js"],"names":[],"mappings":"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","file":"date_nav.js","sourcesContent":["//Libraries\nconst React = require(\"react\")\n    , ReactDOM = require('react-dom')\n    , _     = require(\"lodash/core\");\n_.take = require(\"lodash/take\");\n_.mapValues = require(\"lodash/mapValues\");\n_.reject = require(\"lodash/reject\");\n\n// Utils\nconst checker = require(\"../../utils/day_checker\")\n\n//Mixins\nconst cssMixins    = require(\"morse-react-mixins\").css_mixins\n    , textMixins   = require(\"morse-react-mixins\").text_mixins\n    , widthsMixins = require(\"morse-react-mixins\").widths_mixins;\n\n//Flux\nconst SessionsActions = require(\"../../actions/sessions_actions\")\n    , SessionsStore   = require(\"../../stores/sessions_store\")\n    , ColumnsStore    = require(\"../../stores/columns_store\");\n\n\nconst NavItem = require(\"./stateless/nav_item\")\n    , TodayItem   = require('./stateless/today_nav_item')\n    // , TodayItem   = require(\"./today_nav_item\")\n\nclass DateNav extends React.Component {\n  constructor(props) {\n    super(props);\n    let dates = this._splitDates();\n    let today = dates[0]\n    let current = today.date;\n    this.pos = 0;\n    this.state = {dates:dates[1], today:today, current:current, listWidth:1000, listPos:0};\n\n  }\n\n  componentDidMount(){\n    // console.log(this._setWidth())\n    this.setState({listWidth:this._setWidth()});\n  }\n\n  componentDidUpdate(){\n    let holderWidth = document.querySelector(\".list-holder\").offsetWidth;\n    let listWidth  = this._setWidth();\n    if(listWidth !== this.state.listWidth){\n      this.setState({listWidth:this._setWidth()});\n    } else {\n      let widths = this.state.listWidth + this.state.listPos;\n\n      if(holderWidth > widths){\n        SessionsActions.getMoreDays();\n      }\n    }\n  }\n\n  componentWillMount(){\n    SessionsStore.addChangeListener(\"fetched\", this._getDates.bind(this));\n    SessionsStore.addChangeListener(\"changing_date\", this._getDates.bind(this));\n    SessionsStore.addChangeListener(\"calendar_changing\", this._reset.bind(this));\n    ColumnsStore.addChangeListener(\"change\", this._deviceChange.bind(this));\n  }\n\n  componentWillUnmount() {\n    SessionsStore.removeChangeListener(\"calendar_changing\", this._reset);\n    SessionsStore.removeChangeListener(\"fetched\", this._getDates);\n    SessionsStore.removeChangeListener(\"changing_date\", this._getDates);\n    ColumnsStore.removeChangeListener(\"change\", this._deviceChange);\n  }\n\n  _deviceChange(){\n    this.setState({listWidth:this._setWidth(), device:ColumnsStore.getDevice()})\n  }\n\n  _getDates(){\n    let dates = this._splitDates();\n    let today = dates[0];\n    if(!_.isDate(today.date) || !_.isDate(SessionsStore._getCurrentDate())){\n      alert(today.date + \" : \" + SessionsStore._getCurrentDate())\n    }\n    this.setState({\n      dates:dates[1],\n      today:today,\n      listWidth:this._setWidth(),\n      current:SessionsStore._getCurrentDate()\n    });\n  }\n\n  _getDistance(move){\n    if(_.isEmpty(move)) return 0;\n\n   return  _.reduce(move, (prev, cur)=>{\n      return prev + cur\n    });\n  }\n\n  _getPrevious(pos){\n    if(pos >= 0){\n      let tomorrow = _.clone(this.state.today.date);\n      tomorrow.setDate(tomorrow.getDate()+1);\n      let firstDate = _.first(this.state.dates).date\n      if(!checker(tomorrow, firstDate)){\n        SessionsActions.getPreviousDays(firstDate);\n      }\n    }\n  }\n\n  _mover(dir, e){\n    e.preventDefault();\n    let elms = this.getAllWidths();\n    if(dir === \"left\" && this.pos > 0){\n      this.pos--;\n    } else if((dir === \"right\" && this.pos < elms.length)){\n      this.pos++;\n    }\n\n    let move  = _.map(_.take(elms, this.pos), \"width\");\n    let mover = -this._getDistance(move);\n    this.setState({listPos:mover});\n    this._getPrevious(mover);\n  }\n\n  _setCurrent(date, e){\n    e.preventDefault();\n    SessionsActions.changeDate(date);\n    this.setState({current:date})\n  }\n\n  _setActive(date){\n    return (checker(date, this.state.current)) ? 'active' : '';\n  }\n\n  _setStyle(){\n\n    let styles = {\"width\":this.state.listWidth, left:this.state.listPos}\n    return _.mapValues(styles, (v)=> {\n      return v.toString();\n    });\n  }\n\n  _setWidth(){\n    this.convertDomlist(this.refs.datelist.querySelectorAll(\"li\"));\n    return Math.ceil(this.getWidths());\n  }\n\n  _splitDates(){\n    let dates = SessionsStore._getAllDates();\n    return [_.find(dates, (d)=>d.today), _.reject(dates, (d)=>d.today)]\n  }\n\n  _reset(){\n    this.setState({listPos:0})\n  }\n\n  _renderDates(){\n\n    if(this.state.dates.length){\n      return _.map(this.state.dates, (d)=>{\n        let key = this.createId(d.title, d.date.getDate(), d.date.getMonth());\n        return (<NavItem\n            key      = {key}\n            nav_item = {d}\n            device   = {this.state.device}\n            onClick  = {this._setCurrent.bind(this, d.date)}\n            active   = {this._setActive(d.date)}\n          />)\n      });\n    }\n\n    return [];\n  }\n\n  _renderToday(){\n    let today = this.state.today\n    let key = this.createId(today.title, today.date.getDate(), today.date.getMonth());\n    return (\n     <TodayItem\n        key      = {key}\n        nav_item = {today}\n        device   = {this.state.device}\n        onClick  = {this._setCurrent.bind(this, today.date)}\n        active   = {this._setActive(today.date)}\n      />\n    );\n  }\n\n\n  render(){\n    return (\n      <nav className=\"date-nav\">\n      <a href=\"#\" className=\"nav-mover move-left\" onClick={this._mover.bind(this, \"left\")}>\n        <span className=\"hidden\">left</span>\n      </a>\n      {this._renderToday()}\n      <div className=\"list-holder\">\n        <ul className=\"date-list\" role=\"tablist\" ref=\"datelist\" style={this._setStyle()}>\n          {this._renderDates()}\n        </ul>\n      </div>\n      <a href=\"#\" className=\"nav-mover move-right\" onClick={this._mover.bind(this, \"right\")}>\n        <span className=\"hidden\">right</span>\n      </a>\n      </nav>\n    );\n  }\n\n}\n\nObject.assign(DateNav.prototype, cssMixins);\nObject.assign(DateNav.prototype, textMixins);\nObject.assign(DateNav.prototype, widthsMixins);\n\nmodule.exports = DateNav;"]}