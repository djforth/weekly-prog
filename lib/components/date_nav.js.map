{"version":3,"sources":["../../src/components/date_nav.js"],"names":[],"mappings":"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","file":"date_nav.js","sourcesContent":["//Libraries\nconst React = require(\"react\")\n    , ReactDOM = require('react-dom')\n    , _     = require(\"lodash\");\n\n//Mixins\nconst cssMixins    = require(\"morse-react-mixins\").css_mixins\n    , textMixins   = require(\"morse-react-mixins\").text_mixins\n    , widthsMixins = require(\"morse-react-mixins\").widths_mixins;\n\n//Flux\nconst SessionsActions = require(\"../actions/sessions_actions\")\n    , SessionsStore   = require(\"../stores/sessions_store\");\n\n\nconst DateNavItem = require(\"./date_nav_item\")\n    , TodayItem   = require(\"./today_nav_item\")\n\nclass DateNav extends React.Component {\n  constructor(props) {\n    super(props);\n    let dates = this._splitDates();\n    let today = dates[0]\n    let current = today.date;\n    this.pos = 0;\n    this.state = {dates:dates[1], today:today, current:current, listWidth:1000, listPos:0};\n\n  }\n\n  componentWillMount(){\n    // SessionsStore.addChangeListener(\"prerender\", this._getDates.bind(this));\n    SessionsStore.addChangeListener(\"fetched\", this._getDates.bind(this));\n    SessionsStore.addChangeListener(\"changing_date\", this._getDates.bind(this));\n    SessionsStore.addChangeListener(\"more_days\", this._setContainer.bind(this));\n  }\n\n  componentDidMount(){\n    this.setState({listWidth:this._setWidth()});\n  }\n\n  componentDidUpdate(){\n    let holderWidth = document.querySelector(\".list-holder\").offsetWidth;\n    let listWidth  = this._setWidth();\n    if(listWidth !== this.state.listWidth){\n      this.setState({listWidth:this._setWidth()});\n    } else {\n      let widths = this.state.listWidth + this.state.listPos;\n      if(holderWidth > widths){\n        SessionsActions.getMoreDays();\n      }\n    }\n\n\n    console.log(this._setWidth(), this.state.listWidth)\n  }\n\n  componentWillUnmount() {\n    // SessionsStore.removeChangeListener(\"prerender\", this._getDates);\n    SessionsStore.removeChangeListener(\"fetched\", this._getDates);\n    SessionsStore.removeChangeListener(\"changing_date\", this._getDates);\n    SessionsStore.removeChangeListener(\"more_days\", this._setContainer);\n  }\n\n  _setCurrent(date){\n    this.setState({current:date})\n  }\n\n  _setContainer(){\n    // this.setState({listWidth:this._setWidth()});\n  }\n\n  _setActive(date){\n    return (date.getTime() === this.state.current.getTime());\n  }\n\n  _setStyle(){\n\n    let styles = {\"width\":this.state.listWidth, left:this.state.listPos}\n    // style[k]=v.toString()\n    return _.mapValues(styles, (v)=> {\n      return v.toString();\n    });\n  }\n\n  _setWidth(){\n    this.convertReactComps(this.refs);\n    return Math.ceil(this.getWidths());\n  }\n\n  _splitDates(){\n    let dates = SessionsStore._getAllDates();\n    return [_.find(dates, (d)=>d.today), _.reject(dates, (d)=>d.today)]\n  }\n\n  _getDates(){\n    let dates = this._splitDates();\n    let today = dates[0];\n    this.setState({dates:dates[1], today:today, listWidth:this._setWidth()})\n  }\n\n  _getDistance(move){\n    if(_.isEmpty(move)) return 0;\n\n   return  _.reduce(move, (prev, cur)=>{\n      return prev + cur\n    });\n  }\n\n  _mover(dir, e){\n    e.preventDefault();\n    let elms = this.getAllWidths();\n    if(dir === \"left\" && this.pos > 0){\n      this.pos--;\n    } else if((dir === \"right\" && this.pos < elms.length)){\n      this.pos++;\n    }\n\n    let move = _.pluck(_.take(elms, this.pos), \"width\")\n    this.setState({listPos:-this._getDistance(move)})\n  }\n\n  _renderDates(){\n    if(this.state.dates.length){\n      return _.map(this.state.dates, (d)=>{\n        let key = this.createId(d.title, d.date.getDate(), d.date.getMonth());\n        return (<DateNavItem\n            ref      = {key}\n            key      = {key}\n            nav_item = {d}\n            callback = {this._setCurrent.bind(this)}\n            active   = {this._setActive(d.date)}\n          />)\n      });\n    }\n\n    return [];\n  }\n\n  _renderToday(){\n    let today = this.state.today\n    let key = this.createId(today.title, today.date.getDate(), today.date.getMonth());\n    return (\n     <TodayItem\n        key      = {key}\n        nav_item = {today}\n        callback = {this._setCurrent.bind(this)}\n        active   = {this._setActive(today.date)}\n      />\n    );\n  }\n\n\n  render(){\n    return (\n      <nav className=\"date-nav\">\n      <a href=\"#\" className=\"nav-mover move-left\" onClick={this._mover.bind(this, \"left\")}>\n        <span className=\"hidden\">left</span>\n      </a>\n      {this._renderToday()}\n      <div className=\"list-holder\">\n        <ul className=\"date-list\" role=\"tablist\" style={this._setStyle()}>\n          {this._renderDates()}\n        </ul>\n      </div>\n      <a href=\"#\" className=\"nav-mover move-right\" onClick={this._mover.bind(this, \"right\")}>\n        <span className=\"hidden\">right</span>\n      </a>\n      </nav>\n    );\n  }\n\n}\n\nObject.assign(DateNav.prototype, cssMixins);\nObject.assign(DateNav.prototype, textMixins);\nObject.assign(DateNav.prototype, widthsMixins);\n\nmodule.exports = DateNav;"]}