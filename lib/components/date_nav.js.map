{"version":3,"sources":["../../src/components/date_nav.js"],"names":[],"mappings":"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","file":"date_nav.js","sourcesContent":["//Libraries\nconst React = require(\"react\")\n    , ReactDOM = require('react-dom')\n    , _     = require(\"lodash\");\n\n// Utils\nconst checker = require(\"../utils/day_checker\")\n\n//Mixins\nconst cssMixins    = require(\"morse-react-mixins\").css_mixins\n    , textMixins   = require(\"morse-react-mixins\").text_mixins\n    , widthsMixins = require(\"morse-react-mixins\").widths_mixins;\n\n//Flux\nconst SessionsActions = require(\"../actions/sessions_actions\")\n    , SessionsStore   = require(\"../stores/sessions_store\")\n    , ColumnsStore    = require(\"../stores/columns_store\");\n\n\nconst DateNavItem = require(\"./date_nav_item\")\n    , TodayItem   = require(\"./today_nav_item\")\n\nclass DateNav extends React.Component {\n  constructor(props) {\n    super(props);\n    let dates = this._splitDates();\n    let today = dates[0]\n    let current = today.date;\n    this.pos = 0;\n    this.state = {dates:dates[1], today:today, current:current, listWidth:1000, listPos:0};\n\n  }\n\n  componentDidMount(){\n    this.setState({listWidth:this._setWidth()});\n  }\n\n  componentDidUpdate(){\n    let holderWidth = document.querySelector(\".list-holder\").offsetWidth;\n    let listWidth  = this._setWidth();\n    if(listWidth !== this.state.listWidth){\n      this.setState({listWidth:this._setWidth()});\n    } else {\n      let widths = this.state.listWidth + this.state.listPos;\n\n      if(holderWidth > widths){\n        SessionsActions.getMoreDays();\n      }\n    }\n  }\n\n  componentWillMount(){\n    SessionsStore.addChangeListener(\"fetched\", this._getDates.bind(this));\n    SessionsStore.addChangeListener(\"changing_date\", this._getDates.bind(this));\n    SessionsStore.addChangeListener(\"calendar_changing\", this._reset.bind(this));\n    ColumnsStore.addChangeListener(\"change\", this._deviceChange.bind(this));\n  }\n\n  componentWillUnmount() {\n    SessionsStore.removeChangeListener(\"calendar_changing\", this._reset);\n    SessionsStore.removeChangeListener(\"fetched\", this._getDates);\n    SessionsStore.removeChangeListener(\"changing_date\", this._getDates);\n    ColumnsStore.removeChangeListener(\"change\", this._deviceChange);\n\n  }\n\n  _deviceChange(){\n    this.setState({listWidth:this._setWidth()})\n  }\n\n  _getDates(){\n    let dates = this._splitDates();\n    let today = dates[0];\n    this.setState({\n      dates:dates[1],\n      today:today,\n      listWidth:this._setWidth(),\n      current:SessionsStore._getCurrentDate()\n    });\n  }\n\n  _getDistance(move){\n    if(_.isEmpty(move)) return 0;\n\n   return  _.reduce(move, (prev, cur)=>{\n      return prev + cur\n    });\n  }\n\n  _getPrevious(pos){\n    if(pos >= 0){\n      let tomorrow = _.clone(this.state.today.date);\n      tomorrow.setDate(tomorrow.getDate()+1);\n      let firstDate = _.first(this.state.dates).date\n      if(!checker(tomorrow, firstDate)){\n        SessionsActions.getPreviousDays(firstDate);\n      }\n    }\n  }\n\n  _mover(dir, e){\n    e.preventDefault();\n    let elms = this.getAllWidths();\n    if(dir === \"left\" && this.pos > 0){\n      this.pos--;\n    } else if((dir === \"right\" && this.pos < elms.length)){\n      this.pos++;\n    }\n\n    let move  = _.pluck(_.take(elms, this.pos), \"width\");\n    let mover = -this._getDistance(move);\n    this.setState({listPos:mover});\n    this._getPrevious(mover);\n  }\n\n  _setCurrent(date){\n    this.setState({current:date})\n  }\n\n  _setActive(date){\n    return checker(date, this.state.current);\n  }\n\n  _setStyle(){\n\n    let styles = {\"width\":this.state.listWidth, left:this.state.listPos}\n    return _.mapValues(styles, (v)=> {\n      return v.toString();\n    });\n  }\n\n  _setWidth(){\n    this.convertReactComps(this.refs);\n    return Math.ceil(this.getWidths());\n  }\n\n  _splitDates(){\n    let dates = SessionsStore._getAllDates();\n    return [_.find(dates, (d)=>d.today), _.reject(dates, (d)=>d.today)]\n  }\n\n  _reset(){\n    this.setState({listPos:0})\n  }\n\n  _renderDates(){\n\n    if(this.state.dates.length){\n      return _.map(this.state.dates, (d)=>{\n        let key = this.createId(d.title, d.date.getDate(), d.date.getMonth());\n        return (<DateNavItem\n            ref      = {key}\n            key      = {key}\n            nav_item = {d}\n            device   = {this.props.device}\n            callback = {this._setCurrent.bind(this)}\n            active   = {this._setActive(d.date)}\n          />)\n      });\n    }\n\n    return [];\n  }\n\n  _renderToday(){\n    let today = this.state.today\n    let key = this.createId(today.title, today.date.getDate(), today.date.getMonth());\n    return (\n     <TodayItem\n        key      = {key}\n        nav_item = {today}\n        callback = {this._setCurrent.bind(this)}\n        active   = {this._setActive(today.date)}\n      />\n    );\n  }\n\n\n  render(){\n    return (\n      <nav className=\"date-nav\">\n      <a href=\"#\" className=\"nav-mover move-left\" onClick={this._mover.bind(this, \"left\")}>\n        <span className=\"hidden\">left</span>\n      </a>\n      {this._renderToday()}\n      <div className=\"list-holder\">\n        <ul className=\"date-list\" role=\"tablist\" style={this._setStyle()}>\n          {this._renderDates()}\n        </ul>\n      </div>\n      <a href=\"#\" className=\"nav-mover move-right\" onClick={this._mover.bind(this, \"right\")}>\n        <span className=\"hidden\">right</span>\n      </a>\n      </nav>\n    );\n  }\n\n}\n\nObject.assign(DateNav.prototype, cssMixins);\nObject.assign(DateNav.prototype, textMixins);\nObject.assign(DateNav.prototype, widthsMixins);\n\nmodule.exports = DateNav;"]}