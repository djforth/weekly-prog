{"version":3,"sources":["../../src/components/data_item.js"],"names":[],"mappings":"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","file":"data_item.js","sourcesContent":["const React = require(\"react\")\n    , _     = require(\"lodash\");\n\nconst ColumnsStore   = require(\"../stores/columns_store\");\n\nconst timeChecker = require(\"../utils/time_checker\")\n    , formatter   = require(\"../utils/formatter\");\n\n//Mixins\nlet mixins = require(\"morse-react-mixins\");\nconst [cssMixins, textMixins]  = [mixins.css_mixins, mixins.text_mixins];\n\nclass DataItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.active = [{active:false}];\n    // this._select.bind(this);\n    this.formatter = formatter(this.props.data)\n    this.state = {data:this.props.data, columns:[], datefield:[]};\n\n  }\n\n  componentWillMount() {\n    this.mounted = true;\n    this.setState({data:this.props.data, columns:ColumnsStore.getVisible()});\n    ColumnsStore.addChangeListener(\"change\", this._onChange.bind(this));\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n    ColumnsStore.removeChangeListener(\"change\", this._onChange);\n  }\n\n  _actions(col){\n    let item = this.props.data;\n    let places = item.get(\"places_left\");\n    if(_.isNumber(places) && places === 0){\n      return(<span className=\"session-full\">Session full</span>);\n    }\n\n    if(item.has(\"buttons\") && item.get(\"buttons\").has(\"book\")){\n      let link = item.get(\"buttons\").get(\"book\")\n      return (link === \"#\" || _.isEmpty(link)) ? \"\" : (<a className=\"button button-secondary\" href={link}>Book</a>);\n    }\n\n    return \"\";\n  }\n\n  _onChange(){\n    if(this.mounted){\n      this.setState({\n        columns:ColumnsStore.getVisible()\n      });\n    }\n  }\n\n  _rawMarkup(data) {\n    return <span dangerouslySetInnerHTML={ {__html: data} } />;\n  }\n\n  _renderColumn(col, item){\n    return (\n      <div className={this.checkCss(this.props.css, col.key)} key={_.uniqueId(\"dataItem\")}>\n        {this._wrapper(item, col)}\n      </div>\n    );\n  }\n\n  _renderTd(){\n    let item = this.props.data;\n    if(item && this.state.columns){\n       let td = _.map(this.state.columns, function(col){\n\n         return this._renderColumn(col, item);\n      }.bind(this));\n\n      return td;\n    }\n    return \"\";\n  }\n\n  _setCss(item, col){\n\n    if(!col.type === \"time\" || _.isUndefined(col.concat)) return col.wrapper;\n\n    let checker = timeChecker(item, col);\n    return `${col.wrapper} ${checker.setNowOrPast(\"now\", \"past\")}`;\n  }\n\n  _showValues(col){\n    if(col.key === \"actions\") return this._actions(col);\n\n    let value = this.formatter(col);\n    if(_.isString(value) && value.match(/<|>/g)) return this._rawMarkup(value);\n    if(col.type !== \"time\") return value;\n    let checker = timeChecker(this.props.data, col);\n    return checker.setNowOrPast(null, \"Finished\", value);\n  }\n\n  _wrapper(item, col){\n    if(_.has(col, \"wrapper\")){\n      return (\n        <div className={this._setCss(item, col)}>\n          {this._showValues(col)}\n        </div>);\n    }\n\n    return this._showValues(col);\n  }\n\n\n  render() {\n    return (\n      <div className=\"row tr vPad5\">\n        {this._renderTd()}\n      </div>\n    );\n  }\n\n\n}\n\nObject.assign(DataItem.prototype, cssMixins);\nObject.assign(DataItem.prototype, textMixins);\n\nmodule.exports = DataItem;\n"]}