{"version":3,"sources":["../../src/components/data_item.js"],"names":[],"mappings":"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","file":"data_item.js","sourcesContent":["const React           = require(\"react\");\n// const PureRenderMixin = React.addons.PureRenderMixin;\nconst _               = require(\"lodash\");\n\n// const DataStore      = require(\"../stores/data_store\");\nconst ColumnsStore   = require(\"../stores/columns_store\");\n\n//Mixins\nconst cssMixins  = require(\"morse-react-mixins\").css_mixins;\nconst textMixins = require(\"morse-react-mixins\").text_mixins;\n\nclass DataItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.active = [{active:false}];\n    // this._select.bind(this);\n    this.state = {data:null, columns:[], datefield:[]};\n\n  }\n\n  componentWillMount() {\n    this.mounted = true;\n    this.setState({data:this.props.data, columns:ColumnsStore.getVisible()});\n    ColumnsStore.addChangeListener(\"change\", this._onChange.bind(this));\n  }\n\n\n\n  componentWillUnmount() {\n    this.mounted = false;\n    ColumnsStore.removeChangeListener(\"change\", this._onChange);\n  }\n\n  _getFmt(col){\n    if(_.has(col, \"fmt\")){\n      return col.fmt;\n    }\n\n    if(_.has(col, \"type\") ){\n      if(col.type === \"dateTime\"){\n        return \"%d/%m/%Y %H:%M\";\n      }\n      if(col.type === \"date\"){\n        return \"%d/%m/%Y\";\n      }\n    }\n\n    return \"%d/%m/%Y\";\n  }\n\n  _actions(item, col){\n    if(item.has(\"buttons\") && item.get(\"buttons\").has(\"book\")){\n      return (<a className=\"button button-secondary\" href={item.get(\"buttons\").get(\"book\")}>Book</a>);\n    }\n\n    return(<span class=\"session-full\">Session full</span>);\n  }\n\n  _concatData(item, col){\n    if(col.key === \"actions\") return this._actions(item, col);\n\n    if(_.has(col, \"concat\")) return (`${this._displayData(item, col)} ${col.split} ${this._displayData(item, col, \"concat\")}`);\n\n    return this._displayData(item, col)\n  }\n\n  _displayData(item, col, k=\"key\"){\n    let key  = col[k];\n    let data = item.get(key);\n    if(_.isDate(data)){\n      data = item.get(`${key}Df`);\n      let fmt = this._getFmt(col);\n      return data.formatDate(fmt);\n    }\n\n    return this._rawMarkup(data);\n  }\n\n  _wrapper(item, col){\n    if(_.has(col, \"wrapper\")){\n      return (\n        <div className={col.wrapper}>\n          {this._concatData(item, col)}\n        </div>);\n    }\n\n    return this._concatData(item, col)\n  }\n\n  _renderColumn(col, item){\n    return (\n      <div className={this.checkCss(this.props.css, col.key)} key={_.uniqueId(\"dataItem\")}>\n        {this._wrapper(item, col)}\n      </div>\n    );\n  }\n\n  _rawMarkup(data) {\n    return <span dangerouslySetInnerHTML={ {__html: data} } />;\n  }\n\n  _renderTd(){\n    let item = this.props.data;\n    if(item && this.state.columns){\n       let td = _.map(this.state.columns, function(col){\n\n         return this._renderColumn(col, item);\n      }.bind(this));\n\n      return td;\n    }\n    return \"\";\n  }\n\n\n  render() {\n    return (\n      <div className=\"row tr vPad5\">\n        {this._renderTd()}\n      </div>\n    );\n  }\n\n  _onChange(){\n    if(this.mounted){\n      this.setState({\n        columns:ColumnsStore.getVisible()\n      });\n    }\n\n  }\n}\n\nObject.assign(DataItem.prototype, cssMixins);\nObject.assign(DataItem.prototype, textMixins);\n\nmodule.exports = DataItem;\n"]}