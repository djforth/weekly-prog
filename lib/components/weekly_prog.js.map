{"version":3,"sources":["../../src/components/weekly_prog.js"],"names":[],"mappings":"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","file":"weekly_prog.js","sourcesContent":["//Libraries\nconst React = require('react')\n    , _     = require('lodash/core');\n\n//Mixins\nconst cssMixins    = require('morse-react-mixins').css_mixins\n    , textMixins   = require('morse-react-mixins').text_mixins\n    , widthsMixins = require('morse-react-mixins').widths_mixins;\n\n// Morse Libraies\nconst ViewportDetect = require('viewport-detection-es6');\n\n//Flux\nconst ColumnsActions  = require('../actions/columns_actions')\n    , ColumnsStore    = require('../stores/columns_store')\n    , SessionsActions = require('../actions/sessions_actions')\n    , SessionsStore   = require('../stores/sessions_store');\n\n// Components\nconst DateNav        = require('./nav/date_nav')\n    , PeriodSessions = require('./sessions/period_sessions')\n    , TopBar         = require('./topbar/top_bar');\n\n\nclass WeeklyProg extends React.Component {\n  constructor(props) {\n    super(props);\n    SessionsActions.setGroupby(this.props.groupby);\n\n    this.percent = 0;\n    this.state = {sessions:[], keys:[], visible:[], device:'desktop'};\n  }\n\n  _fetchData(){\n    SessionsStore.removeChangeListener('api_set', this._fetchData);\n    _.defer(()=>{\n      SessionsActions.fetchData()\n    });\n  }\n\n  _getSessions(){\n    let session = SessionsStore._getDate()\n    if (!_.isEmpty(session)) {\n      this.setState({date:session.date, sessions:session.data})\n    }\n  }\n\n  _renderPeriodSessions(){\n    return _.map(this.props.timeperiod, (tp)=>{\n      return (<PeriodSessions {...this.props}\n        devive   = {this.state.device}\n        sessions = {this.state.sessions}\n        time     = {tp.time}\n        title    = {tp.title}\n        key      = {tp.title.toLowerCase()} />)\n    });\n  }\n\n  componentWillMount(){\n    SessionsStore.addChangeListener('prerender', this._getSessions.bind(this));\n    let ses = (_.isEmpty(this.props.sessions)) ? [] : this.props.sessions\n    SessionsActions.prerenderData(ses);\n    ColumnsActions.addingColumns(this.props.columns);\n    ColumnsActions.changeDevice(this.device);\n  }\n\n  componentDidMount(){\n    this.detect = new ViewportDetect();\n    this.device = this.detect.getDevice();\n    this.size  = this.detect.windowSize();\n    ColumnsActions.changeDevice(this.device);\n\n    this.id = this.detect.trackSize(this._onDeviceChange.bind(this));\n    SessionsStore.addChangeListener('api_set', this._fetchData.bind(this));\n    SessionsActions.setApi(this.props.sessionsApi);\n  }\n\n  componentWillUnmount() {\n    this.detect.removeCallback(this.id);\n    SessionsStore.removeChangeListener('prerender', this._getSessions);\n  }\n\n  _onDeviceChange(device, size){\n    if (this.device !== device){\n      this.device = device;\n      ColumnsActions.changeDevice(device);\n    }\n    this.size   = size;\n  }\n\n  render(){\n    return (\n      <div className='weekly-prog'>\n        <TopBar\n          device={this.state.device}\n          print={this.props.print}\n        />\n        <DateNav />\n        <div id='sessions' className='clearfix'>\n          {this._renderPeriodSessions()}\n        </div>\n      </div>\n    );\n  }\n\n}\n\nObject.assign(WeeklyProg.prototype, cssMixins);\nObject.assign(WeeklyProg.prototype, textMixins);\nObject.assign(WeeklyProg.prototype, widthsMixins);\n\nmodule.exports = WeeklyProg;\n"]}