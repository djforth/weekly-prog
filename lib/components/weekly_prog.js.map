{"version":3,"sources":["../../src/components/weekly_prog.js"],"names":[],"mappings":"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","file":"weekly_prog.js","sourcesContent":["//Libraries\nconst React = require(\"react\")\n    , _     = require(\"lodash/core\");\n\n//Mixins\nconst cssMixins    = require(\"morse-react-mixins\").css_mixins\n    , textMixins   = require(\"morse-react-mixins\").text_mixins\n    , widthsMixins = require(\"morse-react-mixins\").widths_mixins;\n\n// Morse Libraies\nconst ViewportDetect = require(\"viewport-detection-es6\");\n\n//Flux\nconst ColumnsActions  = require(\"../actions/columns_actions\")\n    , ColumnsStore    = require(\"../stores/columns_store\")\n    , SessionsActions = require(\"../actions/sessions_actions\")\n    , SessionsStore   = require(\"../stores/sessions_store\");\n\n// Components\nconst DateNav        = require(\"./date_nav\")\n    , Calendar       = require(\"./calendar\")\n    , PeriodSessions = require(\"./period_sessions\")\n    , PrintBtn       = require(\"./print_btn\");\n\n\nclass WeeklyProg extends React.Component {\n  constructor(props) {\n    super(props);\n    SessionsActions.setGroupby(this.props.groupby);\n\n    this.percent = 0;\n    this.state = {sessions:[], keys:[], visible:[], device:\"desktop\"};\n  }\n\n  _fetchData(){\n\n    SessionsStore.removeChangeListener(\"api_set\", this._fetchData);\n    _.defer(()=>{\n      SessionsActions.fetchData()\n    });\n  }\n\n  _getSessions(){\n\n    let session = SessionsStore._getDate()\n    if(!_.isEmpty(session)) {\n      this.setState({date:session.date, sessions:session.data})\n    }\n  }\n\n\n\n  _renderPeriodSessions(){\n    return _.map(this.props.timeperiod, (tp)=>{\n      return (<PeriodSessions {...this.props}\n        devive   = {this.state.device}\n        sessions = {this.state.sessions}\n        time     = {tp.time}\n        title    = {tp.title}\n        key      = {tp.title.toLowerCase()} />)\n    });\n  }\n\n  componentWillMount(){\n\n    SessionsStore.addChangeListener(\"prerender\", this._getSessions.bind(this));\n    let ses = (_.isEmpty(this.props.sessions)) ? [] : this.props.sessions\n    SessionsActions.prerenderData(ses);\n\n\n    ColumnsActions.addingColumns(this.props.columns);\n    ColumnsActions.changeDevice(this.device);\n\n\n  }\n\n  componentDidMount(){\n    this.detect = new ViewportDetect();\n    this.device = this.detect.getDevice();\n    this.size  = this.detect.windowSize();\n    ColumnsActions.changeDevice(this.device);\n    // this.setState({device:this.device});\n    this.id = this.detect.trackSize(this._onDeviceChange.bind(this));\n\n    // SessionsStore.addChangeListener(\"fetched\", this._onLoaded.bind(this));\n    SessionsStore.addChangeListener(\"api_set\", this._fetchData.bind(this));\n    SessionsActions.setApi(this.props.sessionsApi);\n\n  }\n\n  componentWillUnmount() {\n    this.detect.removeCallback(this.id);\n    SessionsStore.removeChangeListener(\"prerender\", this._getSessions);\n    // SessionsStore.removeChangeListener(\"fetched\", this._onLoaded);\n  }\n\n  _onDeviceChange(device, size){\n      if(this.device !== device){\n        this.device = device;\n        ColumnsActions.changeDevice(device);\n      }\n\n      this.size   = size;\n\n  }\n\n\n  render(){\n\n    return (\n    <div className=\"weekly-prog\">\n      <div className=\"clearfix calendar-bar\">\n        <Calendar device={this.state.device} />\n        <PrintBtn print={this.props.print} />\n      </div>\n      <DateNav device={this.state.device} />\n      <div id=\"sessions\" className=\"clearfix\">\n      {this._renderPeriodSessions()}\n      </div>\n\n    </div>\n\n    );\n  }\n\n}\n\nObject.assign(WeeklyProg.prototype, cssMixins);\nObject.assign(WeeklyProg.prototype, textMixins);\nObject.assign(WeeklyProg.prototype, widthsMixins);\n\nmodule.exports = WeeklyProg;\n"]}