{"version":3,"sources":["../../../src/components/niu/now_next.js"],"names":[],"mappings":"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","file":"now_next.js","sourcesContent":["//Libraries\nconst React = require('react')\n    , _     = require('lodash/core');\n\n//Mixins\nconst cssMixins    = require('morse-react-mixins').css_mixins\n    , textMixins   = require('morse-react-mixins').text_mixins\n    , widthsMixins = require('morse-react-mixins').widths_mixins;\n\n// Morse Libraies\nconst ViewportDetect = require('viewport-detection-es6');\n\n//utiles\nconst process_nav = require('../utils/process_nav');\n\n//Flux\nconst ColumnsActions  = require('../actions/columns_actions')\n    , ColumnsStore    = require('../stores/columns_store')\n    , SessionsActions = require('../actions/sessions_actions')\n    , SessionsStore   = require('../stores/sessions_store');\n\n// Components\nconst DataHead     = require('./data_head')\n    , NowNextItems = require('./nownext_sessions')\n    , TouchNav     = require('touch-nav');\n\n\nclass NowNext extends React.Component {\n  constructor(props) {\n    super(props);\n    let navitems = process_nav(this.props.navitems, this.props.title_tag)\n    SessionsActions.setGroupby(this.props.groupby);\n    SessionsActions.setFacility(_.first(this.props.navitems).id)\n    this.percent = 0;\n    this.state = {sessions:[], keys:[], visible:[], device:'desktop', navitems:navitems};\n  }\n\n  //React life cycle\n  componentWillMount(){\n    SessionsStore.addChangeListener('prerender', this._getSessions.bind(this));\n    SessionsActions.prerenderData(this.props.sessions);\n    ColumnsActions.addingColumns(this.props.columns);\n    ColumnsActions.changeDevice(this.device);\n\n     // this._getSessions();\n  }\n\n  componentDidMount(){\n    this.detect = new ViewportDetect();\n    this.device = this.detect.getDevice();\n    this.size  = this.detect.windowSize();\n    ColumnsActions.changeDevice(this.device);\n    // this.setState({device:this.device});\n    this.id = this.detect.trackSize(this._onDeviceChange.bind(this));\n    this.detect.trackSize(function(device, size){\n      if (this.device !== device){\n        this.device = device;\n        ColumnsActions.changeDevice(device);\n      }\n\n      this.size   = size;\n\n    }.bind(this));\n\n    SessionsStore.addChangeListener('api_set', this._fetchData.bind(this));\n    SessionsActions.setApi(this.props.sessionsApi);\n\n  }\n\n  componentWillUnmount() {\n    this.detect.removeCallback(this.id);\n    SessionsStore.removeChangeListener('prerender', this._getSessions);\n  }\n\n  _onDeviceChange(device, size){\n      if (this.device !== device){\n        this.device = device;\n        ColumnsActions.changeDevice(device);\n      }\n\n      this.size   = size;\n\n  }\n\n  _fetchData(){\n    SessionsStore.removeChangeListener('api_set', this._fetchData);\n    _.defer(()=>{\n      SessionsActions.fetchNowNext();\n    });\n  }\n\n  _onClick(id, ...args){\n    // console.log('click', args)\n    SessionsActions.setFacility(id);\n  }\n\n  _getSessions(){\n    let session = SessionsStore._getDate();\n    if (!_.isEmpty(session)) {\n      this.setState({date:session.date, sessions:session.data})\n    }\n  }\n\n  render(){\n    return(\n      <div className='now-next'>\n        <TouchNav navitems={this.state.navitems} callback={this._onClick.bind(this)} />\n        <div className='table weekly-prog'>\n          <DataHead device={this.props.device} css={this.props.css} key={'head'} />\n          <div className='tbody'>\n            <NowNextItems {...this.props} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n}\n\nObject.assign(NowNext.prototype, cssMixins);\nObject.assign(NowNext.prototype, textMixins);\nObject.assign(NowNext.prototype, widthsMixins);\n\nmodule.exports = NowNext;\n"]}