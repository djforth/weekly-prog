{"version":3,"sources":["../../../src/components/niu/now_next.js"],"names":[],"mappings":"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","file":"now_next.js","sourcesContent":["//Libraries\nconst React = require(\"react\")\n    , _     = require(\"lodash/core\");\n\n//Mixins\nconst cssMixins    = require(\"morse-react-mixins\").css_mixins\n    , textMixins   = require(\"morse-react-mixins\").text_mixins\n    , widthsMixins = require(\"morse-react-mixins\").widths_mixins;\n\n// Morse Libraies\nconst ViewportDetect = require(\"viewport-detection-es6\");\n\n//utiles\nconst process_nav = require(\"../utils/process_nav\");\n\n//Flux\nconst ColumnsActions  = require(\"../actions/columns_actions\")\n    , ColumnsStore    = require(\"../stores/columns_store\")\n    , SessionsActions = require(\"../actions/sessions_actions\")\n    , SessionsStore   = require(\"../stores/sessions_store\");\n\n// Components\nconst DataHead     = require(\"./data_head\")\n    , NowNextItems = require(\"./nownext_sessions\")\n    , TouchNav     = require(\"touch-nav\");\n\n\nclass NowNext extends React.Component {\n  constructor(props) {\n    super(props);\n    let navitems = process_nav(this.props.navitems, this.props.title_tag)\n    SessionsActions.setGroupby(this.props.groupby);\n    SessionsActions.setFacility(_.first(this.props.navitems).id)\n    this.percent = 0;\n    this.state = {sessions:[], keys:[], visible:[], device:\"desktop\", navitems:navitems};\n  }\n\n  //React life cycle\n  componentWillMount(){\n    SessionsStore.addChangeListener(\"prerender\", this._getSessions.bind(this));\n    SessionsActions.prerenderData(this.props.sessions);\n    ColumnsActions.addingColumns(this.props.columns);\n    ColumnsActions.changeDevice(this.device);\n\n     // this._getSessions();\n  }\n\n  componentDidMount(){\n    this.detect = new ViewportDetect();\n    this.device = this.detect.getDevice();\n    this.size  = this.detect.windowSize();\n    ColumnsActions.changeDevice(this.device);\n    // this.setState({device:this.device});\n    this.id = this.detect.trackSize(this._onDeviceChange.bind(this));\n    this.detect.trackSize(function(device, size){\n      if(this.device !== device){\n        this.device = device;\n        ColumnsActions.changeDevice(device);\n      }\n\n      this.size   = size;\n\n    }.bind(this));\n\n    SessionsStore.addChangeListener(\"api_set\", this._fetchData.bind(this));\n    SessionsActions.setApi(this.props.sessionsApi);\n\n  }\n\n  componentWillUnmount() {\n    this.detect.removeCallback(this.id);\n    SessionsStore.removeChangeListener(\"prerender\", this._getSessions);\n  }\n\n  _onDeviceChange(device, size){\n      if(this.device !== device){\n        this.device = device;\n        ColumnsActions.changeDevice(device);\n      }\n\n      this.size   = size;\n\n  }\n\n  _fetchData(){\n    SessionsStore.removeChangeListener(\"api_set\", this._fetchData);\n    _.defer(()=>{\n      SessionsActions.fetchNowNext();\n    });\n  }\n\n  _onClick(id, ...args){\n    // console.log(\"click\", args)\n    SessionsActions.setFacility(id);\n  }\n\n  _getSessions(){\n    let session = SessionsStore._getDate();\n    if(!_.isEmpty(session)) {\n      this.setState({date:session.date, sessions:session.data})\n    }\n  }\n\n  render(){\n    return(\n      <div className=\"now-next\">\n        <TouchNav navitems={this.state.navitems} callback={this._onClick.bind(this)} />\n        <div className=\"table weekly-prog\">\n          <DataHead device={this.props.device} css={this.props.css} key={\"head\"} />\n          <div className=\"tbody\">\n            <NowNextItems {...this.props} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n}\n\nObject.assign(NowNext.prototype, cssMixins);\nObject.assign(NowNext.prototype, textMixins);\nObject.assign(NowNext.prototype, widthsMixins);\n\nmodule.exports = NowNext;\n"]}