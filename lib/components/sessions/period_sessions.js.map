{"version":3,"sources":["../../../src/components/sessions/period_sessions.js"],"names":["React","DataHead","DataExpander","NoSessions","Paginate","PeriodHead","ColumnsStore","SessionsStore","css_mixins","cssMixins","text_mixins","textMixins","PeriodSessions","props","st","fn","sessions","hidden","time","getTimePeriod","size","pagination","state","columns","data","keys","visible","device","paginate","pagination_css","getClasses","setState","getVisible","addChangeListener","_onChange","bind","_onLoaded","removeChangeListener","_renderSessions","_renderNoSessions","no_sessions","title","slice","map","d","css","createId","get","_setCss","_renderData","_paginate","toLowerCase","getKeyAndTitle","_getDate","e","preventDefault","pag","toggleCss","Component","Object","assign","prototype"],"mappings":";;;;;;;;AAAA;;AAEA,OAAOA,KAAP,MAAkB,OAAlB;;AAGA,OAAOC,QAAP,MAAqB,aAArB;;AAEA,OAAOC,YAAP,MAAyB,sBAAzB;;AAEA,OAAOC,UAAP,MAAuB,yBAAvB;;AAEA,OAAOC,QAAP,MAAqB,sBAArB;;AAEA,OAAOC,UAAP,MAAuB,yBAAvB;;AAEA;;AAEA,OAAOC,YAAP,MAAyB,4BAAzB;;AAEA,OAAOC,aAAP,MAA0B,6BAA1B;;AAEA;AACA,SACEC,cAAcC,SADhB,EAEIC,eAAeC,UAFnB,QAGO,oBAHP;;IAKMC,c;;;AACJ,0BAAYC,KAAZ,EAAkB;AAAA;;AAAA,gIACVA,KADU;;AAEhB,QAAIC,WAAJ;AAAA,QAAQC,WAAR;AAAA,QAAYC,iBAAZ;AAAA,QAAsBC,eAAtB;AACAH,SAAK,MAAKD,KAAL,CAAWK,IAAX,CAAgBJ,EAArB;AACAC,SAAK,MAAKF,KAAL,CAAWK,IAAX,CAAgBH,EAArB;AACAC,eAAW,MAAKH,KAAL,CAAWG,QAAX,CAAoBG,aAApB,CAAkCL,EAAlC,EAAsCC,EAAtC,CAAX;;AAEAE,aAAUD,SAASI,IAAT,IAAiB,GAA3B;AACA,UAAKC,UAAL,GAAkB,CAAC,mBAAD,EAAsB,EAACJ,QAAQA,MAAT,EAAtB,CAAlB;;AAEA,UAAKK,KAAL,GAAa;AACXC,eAAS,EADE;AAETC,YAAMR,QAFG;AAGTS,YAAM,EAHG;AAITC,eAAS,EAJA;AAKTC,cAAQ,SALC;AAMTC,gBAAU,CAND;AAOTC,sBAAgB,MAAKC,UAAL,CAAgB,MAAKT,UAArB;AAPP,KAAb;AAVgB;AAmBjB;;;;yCAEmB;AAClB,WAAKU,QAAL,CAAc,EAACR,SAASjB,aAAa0B,UAAb,EAAV,EAAd;AACD;;;wCAEkB;AACjB;AACA1B,mBAAa2B,iBAAb,CAA+B,QAA/B,EAAyC,KAAKC,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAzC;AACA5B,oBAAc0B,iBAAd,CAAgC,eAAhC,EAAiD,KAAKG,SAAL,CAAeD,IAAf,CAAoB,IAApB,CAAjD;AACA5B,oBAAc0B,iBAAd,CAAgC,SAAhC,EAA2C,KAAKG,SAAL,CAAeD,IAAf,CAAoB,IAApB,CAA3C;AACD;;;2CAEqB;AACpB5B,oBAAc8B,oBAAd,CAAmC,eAAnC,EAAoD,KAAKD,SAAzD;AACA7B,oBAAc8B,oBAAd,CAAmC,SAAnC,EAA8C,KAAKD,SAAnD;AACA9B,mBAAa+B,oBAAb,CAAkC,QAAlC,EAA4C,KAAKH,SAAjD;AACD;;;kCAEY;AACX,UAAI,KAAKZ,KAAL,CAAWE,IAAX,IAAmB,KAAKF,KAAL,CAAWE,IAAX,CAAgBJ,IAAhB,GAAuB,CAA9C,EAAgD;AAC9C,eAAO,KAAKkB,eAAL,EAAP;AACD;AACD,aAAO,KAAKC,iBAAL,EAAP;AACD;;;wCAEkB;AACjB,aACI,oBAAC,UAAD;AACE,oBAAY,KAAK1B,KAAL,CAAW2B,WADzB;AAEE,eAAO,KAAK3B,KAAL,CAAW4B,KAFpB,GADJ;AAID;;;sCAEgB;AAAA;;AACf,UAAIjB,OAAO,KAAKF,KAAL,CAAWE,IAAX,CAAgBkB,KAAhB,CAAsB,CAAtB,EAAyB,KAAKpB,KAAL,CAAWM,QAApC,CAAX;AACA,aAAOJ,KAAKmB,GAAL,CAAS,UAACC,CAAD,EAAK;AACnB,eACE,oBAAC,YAAD;AACE,eAAQ,OAAK/B,KAAL,CAAWgC,GADrB;AAEE,gBAAQD,CAFV;AAGE,eAAQ,OAAKE,QAAL,CAAc,SAAd,EAAyBF,EAAEG,GAAF,CAAM,IAAN,CAAzB,CAHV,GADF;AAMD,OAPM,CAAP;AAQD;;;6BAEO;;AAEN,aACE;AAAA;AAAA,UAAS,KAAI,OAAb,EAAqB,WAAW,KAAKC,OAAL,EAAhC;AACE,4BAAC,UAAD,IAAY,OAAO,KAAKnC,KAAL,CAAW4B,KAA9B,GADF;AAEE;AAAA;AAAA,YAAK,WAAU,OAAf;AACE,8BAAC,QAAD,IAAU,SAAS,KAAKnB,KAAL,CAAWC,OAA9B,EAAuC,KAAK,KAAKV,KAAL,CAAWgC,GAAvD,GADF;AAEE;AAAA;AAAA,cAAK,WAAU,OAAf;AACG,iBAAKI,WAAL,CAAiB,KAAK3B,KAAL,CAAWM,QAA5B;AADH;AAFF,SAFF;AAQE,4BAAC,QAAD;AACE,eAAW,KAAKN,KAAL,CAAWO,cADxB;AAEE,mBAAW,KAAKqB,SAAL,CAAef,IAAf,CAAoB,IAApB;AAFb;AARF,OADF;AAgBD;;;8BAEQ;AACP,wBAAgB,KAAKtB,KAAL,CAAW4B,KAAX,CAAiBU,WAAjB,EAAhB;AACD;;;gCAEU;AACT,UAAI5B,UAAUjB,aAAa8C,cAAb,EAAd;AACA,WAAKrB,QAAL,CAAc;AACZR,iBAASA;AADG,OAAd;AAGD;;;gCAEU;AACT,UAAIP,iBAAJ;AAAA,UAAcF,WAAd;AAAA,UAAkBC,WAAlB;AACAD,WAAK,KAAKD,KAAL,CAAWK,IAAX,CAAgBJ,EAArB;AACAC,WAAK,KAAKF,KAAL,CAAWK,IAAX,CAAgBH,EAArB;AACAC,iBAAWT,cAAc8C,QAAd,GAAyB7B,IAApC;AACAR,iBAAWA,SAASG,aAAT,CAAuBL,EAAvB,EAA2BC,EAA3B,CAAX;AACA,WAAKM,UAAL,CAAgB,CAAhB,EAAmBJ,MAAnB,GAA6BD,SAASI,IAAT,IAAiB,GAA9C;AACA,WAAKW,QAAL,CAAc;AACZH,kBAAU,GADE;AAEVC,wBAAgB,KAAKC,UAAL,CAAgB,KAAKT,UAArB,CAFN;AAGVG,cAAMR;AAHI,OAAd;AAKD;;;8BAESsC,C,EAAE;AACVA,QAAEC,cAAF;AACA,UAAIC,MAAM,KAAKlC,KAAL,CAAWM,QAAX,GAAsB,EAAhC;AACA,UAAI4B,MAAM,KAAKlC,KAAL,CAAWE,IAAX,CAAgBJ,IAA1B,EAA+B;AAC7B,aAAKC,UAAL,GAAmB,KAAKoC,SAAL,CAAe,KAAKpC,UAApB,CAAnB;AACD;;AAED,WAAKU,QAAL,CAAc;AACZH,kBAAU4B,GADE;AAEV3B,wBAAgB,KAAKC,UAAL,CAAgB,KAAKT,UAArB;AAFN,OAAd;AAID;;;;EAzH0BrB,MAAM0D,S;;AA4HnCC,OAAOC,MAAP,CAAchD,eAAeiD,SAA7B,EAAwCpD,SAAxC;AACAkD,OAAOC,MAAP,CAAchD,eAAeiD,SAA7B,EAAwClD,UAAxC;;AAEA,eAAeC,cAAf","file":"period_sessions.js","sourcesContent":["// Libraries\n\nimport React from 'react';\n\n\nimport DataHead from './data_head';\n\nimport DataExpander from './data_expander_item';\n\nimport NoSessions from './stateless/no_sessions';\n\nimport Paginate from './stateless/paginate';\n\nimport PeriodHead from './stateless/period_head';\n\n// Flux\n\nimport ColumnsStore from '../../stores/columns_store';\n\nimport SessionsStore from '../../stores/sessions_store';\n\n// Mixins\nimport {\n  css_mixins as cssMixins\n  , text_mixins as textMixins\n} from 'morse-react-mixins';\n\nclass PeriodSessions extends React.Component{\n  constructor(props){\n    super(props);\n    let st, fn, sessions, hidden;\n    st = this.props.time.st;\n    fn = this.props.time.fn;\n    sessions = this.props.sessions.getTimePeriod(st, fn);\n\n    hidden = (sessions.size <= 100);\n    this.pagination = ['weekly-pagination', {hidden: hidden}];\n\n    this.state = {\n      columns: []\n      , data: sessions\n      , keys: []\n      , visible: []\n      , device: 'desktop'\n      , paginate: 4\n      , pagination_css: this.getClasses(this.pagination)\n    };\n  }\n\n  componentWillMount(){\n    this.setState({columns: ColumnsStore.getVisible()});\n  }\n\n  componentDidMount(){\n    // Data Changers\n    ColumnsStore.addChangeListener('change', this._onChange.bind(this));\n    SessionsStore.addChangeListener('changing_date', this._onLoaded.bind(this));\n    SessionsStore.addChangeListener('fetched', this._onLoaded.bind(this));\n  }\n\n  componentWillUnmount(){\n    SessionsStore.removeChangeListener('changing_date', this._onLoaded);\n    SessionsStore.removeChangeListener('fetched', this._onLoaded);\n    ColumnsStore.removeChangeListener('change', this._onChange);\n  }\n\n  _renderData(){\n    if (this.state.data && this.state.data.size > 0){\n      return this._renderSessions();\n    }\n    return this._renderNoSessions();\n  }\n\n  _renderNoSessions(){\n    return (\n        <NoSessions\n          no_session={this.props.no_sessions}\n          title={this.props.title} />);\n  }\n\n  _renderSessions(){\n    let data = this.state.data.slice(0, this.state.paginate);\n    return data.map((d)=>{\n      return (\n        <DataExpander\n          css  = {this.props.css}\n          data = {d}\n          key  = {this.createId('session', d.get('id'))} />\n        );\n    });\n  }\n\n  render(){\n\n    return (\n      <section key=\"items\" className={this._setCss()}>\n        <PeriodHead title={this.props.title} />\n        <div className=\"table\">\n          <DataHead columns={this.state.columns} css={this.props.css}  />\n          <div className=\"tbody\">\n            {this._renderData(this.state.paginate)}\n          </div>\n        </div>\n        <Paginate\n          css     = {this.state.pagination_css}\n          onClick = {this._paginate.bind(this)}\n        />\n\n      </section>\n    );\n  }\n\n  _setCss(){\n    return `panel ${this.props.title.toLowerCase()}`;\n  }\n\n  _onChange(){\n    let columns = ColumnsStore.getKeyAndTitle();\n    this.setState({\n      columns: columns\n    });\n  }\n\n  _onLoaded(){\n    let sessions, st, fn;\n    st = this.props.time.st;\n    fn = this.props.time.fn;\n    sessions = SessionsStore._getDate().data;\n    sessions = sessions.getTimePeriod(st, fn);\n    this.pagination[1].hidden = (sessions.size <= 100);\n    this.setState({\n      paginate: 100\n      , pagination_css: this.getClasses(this.pagination)\n      , data: sessions\n    });\n  }\n\n  _paginate(e){\n    e.preventDefault();\n    let pag = this.state.paginate + 10;\n    if (pag > this.state.data.size){\n      this.pagination  = this.toggleCss(this.pagination);\n    }\n\n    this.setState({\n      paginate: pag\n      , pagination_css: this.getClasses(this.pagination)\n    });\n  }\n}\n\nObject.assign(PeriodSessions.prototype, cssMixins);\nObject.assign(PeriodSessions.prototype, textMixins);\n\nexport default PeriodSessions;\n"]}