{"version":3,"sources":["../../../src/components/sessions/period_sessions.jsx"],"names":["PeriodSessions","props","st","fn","sessions","hidden","time","getTimePeriod","size","pagination","state","columns","data","keys","visible","device","paginate","pagination_css","getClasses","setState","getVisible","addChangeListener","_onChange","bind","_onLoaded","removeChangeListener","_renderSessions","_renderNoSessions","no_sessions","title","slice","map","d","css","createId","get","_setCss","_renderData","_paginate","toLowerCase","getKeyAndTitle","_getDate","e","preventDefault","pag","toggleCss","Component","Object","assign","prototype"],"mappings":"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","file":"period_sessions.js","sourcesContent":["// Libraries\nimport React from 'react';\n\nimport DataHead from './data_head';\nimport DataExpander from './data_expander_item';\nimport NoSessions from './stateless/no_sessions';\nimport Paginate from './stateless/paginate';\nimport PeriodHead from './stateless/period_head';\n\n// Flux\nimport ColumnsStore from '../../stores/columns_store';\nimport SessionsStore from '../../stores/sessions_store';\n\n// Mixins\nimport {\n  css_mixins as cssMixins\n  , text_mixins as textMixins\n} from 'morse-react-mixins';\n\nclass PeriodSessions extends React.Component{\n  constructor(props){\n    super(props);\n    let st, fn, sessions, hidden;\n    st = this.props.time.st;\n    fn = this.props.time.fn;\n    sessions = this.props.sessions.getTimePeriod(st, fn);\n\n    hidden = (sessions.size <= 100);\n    this.pagination = ['weekly-pagination', {hidden: hidden}];\n\n    this.state = {\n      columns: []\n      , data: sessions\n      , keys: []\n      , visible: []\n      , device: 'desktop'\n      , paginate: 4\n      , pagination_css: this.getClasses(this.pagination)\n    };\n  }\n\n  componentWillMount(){\n    this.setState({columns: ColumnsStore.getVisible()});\n  }\n\n  componentDidMount(){\n    // Data Changers\n    ColumnsStore.addChangeListener('change', this._onChange.bind(this));\n    SessionsStore.addChangeListener('changing_date', this._onLoaded.bind(this));\n    SessionsStore.addChangeListener('fetched', this._onLoaded.bind(this));\n  }\n\n  componentWillUnmount(){\n    SessionsStore.removeChangeListener('changing_date', this._onLoaded);\n    SessionsStore.removeChangeListener('fetched', this._onLoaded);\n    ColumnsStore.removeChangeListener('change', this._onChange);\n  }\n\n  _renderData(){\n    if (this.state.data && this.state.data.size > 0){\n      return this._renderSessions();\n    }\n    return this._renderNoSessions();\n  }\n\n  _renderNoSessions(){\n    return (\n        <NoSessions\n          no_session={this.props.no_sessions}\n          title={this.props.title} />);\n  }\n\n  _renderSessions(){\n    let data = this.state.data.slice(0, this.state.paginate);\n    return data.map((d)=>{\n      return (\n        <DataExpander\n          css  = {this.props.css}\n          data = {d}\n          key  = {this.createId('session', d.get('id'))} />\n        );\n    });\n  }\n\n  render(){\n    return (\n      <section key=\"items\" className={this._setCss()}>\n        <PeriodHead title={this.props.title} />\n        <div className=\"table\">\n          <DataHead columns={this.state.columns} css={this.props.css}  />\n          <div className=\"tbody\">\n            {this._renderData(this.state.paginate)}\n          </div>\n        </div>\n        <Paginate\n          css     = {this.state.pagination_css}\n          onClick = {this._paginate.bind(this)}\n        />\n\n      </section>\n    );\n  }\n\n  _setCss(){\n    return `panel ${this.props.title.toLowerCase()}`;\n  }\n\n  _onChange(){\n    let columns = ColumnsStore.getKeyAndTitle();\n    this.setState({\n      columns: columns\n    });\n  }\n\n  _onLoaded(){\n    let sessions, st, fn;\n    st = this.props.time.st;\n    fn = this.props.time.fn;\n    sessions = SessionsStore._getDate().data;\n    sessions = sessions.getTimePeriod(st, fn);\n    this.pagination[1].hidden = (sessions.size <= 100);\n    this.setState({\n      paginate: 100\n      , pagination_css: this.getClasses(this.pagination)\n      , data: sessions\n    });\n  }\n\n  _paginate(e){\n    e.preventDefault();\n    let pag = this.state.paginate + 10;\n    if (pag > this.state.data.size){\n      this.pagination  = this.toggleCss(this.pagination);\n    }\n\n    this.setState({\n      paginate: pag\n      , pagination_css: this.getClasses(this.pagination)\n    });\n  }\n}\n\nObject.assign(PeriodSessions.prototype, cssMixins);\nObject.assign(PeriodSessions.prototype, textMixins);\n\nexport default PeriodSessions;\n"]}