{"version":3,"sources":["../../../src/components/sessions/period_sessions.js"],"names":[],"mappings":"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","file":"period_sessions.js","sourcesContent":["// Libraries\nconst React = require('react');\n\nconst DataHead     = require('./data_head')\n    , DataExpander = require('./data_expander_item')\n    , NoSessions   = require('./stateless/no_sessions')\n    , Paginate     = require('./stateless/paginate')\n    , PeriodHead   = require('./stateless/period_head');\n\n// Flux\nconst ColumnsStore   = require('../../stores/columns_store')\n    , SessionsStore = require('../../stores/sessions_store');\n\n// Mixins\nconst cssMixins  = require('morse-react-mixins').css_mixins\n    , textMixins = require('morse-react-mixins').text_mixins;\n\nclass PeriodSessions extends React.Component{\n  constructor(props){\n    super(props);\n    let st, fn, sessions, hidden;\n    st = this.props.time.st;\n    fn = this.props.time.fn;\n    sessions = this.props.sessions.getTimePeriod(st, fn);\n\n    hidden = (sessions.size <= 100);\n    this.pagination = ['weekly-pagination', {hidden: hidden}];\n\n    this.state = {\n      columns: []\n      , data: sessions\n      , keys: []\n      , visible: []\n      , device: 'desktop'\n      , paginate: 4\n      , pagination_css: this.getClasses(this.pagination)\n    };\n  }\n\n  componentWillMount(){\n    this.setState({columns: ColumnsStore.getVisible()});\n  }\n\n  componentDidMount(){\n    // Data Changers\n    ColumnsStore.addChangeListener('change', this._onChange.bind(this));\n    SessionsStore.addChangeListener('changing_date', this._onLoaded.bind(this));\n    SessionsStore.addChangeListener('fetched', this._onLoaded.bind(this));\n  }\n\n  componentWillUnmount(){\n    SessionsStore.removeChangeListener('changing_date', this._onLoaded);\n    SessionsStore.removeChangeListener('fetched', this._onLoaded);\n    ColumnsStore.removeChangeListener('change', this._onChange);\n  }\n\n  _renderData(){\n    if (this.state.data && this.state.data.size > 0){\n      return this._renderSessions();\n    }\n    return this._renderNoSessions();\n  }\n\n  _renderNoSessions(){\n    return (\n        <NoSessions\n          no_session={this.props.no_sessions}\n          title={this.props.title} />);\n  }\n\n  _renderSessions(){\n    let data = this.state.data.slice(0, this.state.paginate);\n     // console.log(data)\n    return data.map((d)=>{\n      return (\n        <DataExpander\n          css  = {this.props.css}\n          data = {d}\n          key  = {this.createId('session', d.get('id'))} />\n        );\n    });\n  }\n\n  render(){\n    return (\n      <section key=\"items\" className={this._setCss()}>\n        <PeriodHead title={this.props.title} />\n        <div className=\"table\">\n          <DataHead columns={this.state.columns} css={this.props.css}  />\n          <div className=\"tbody\">\n            {this._renderData(this.state.paginate)}\n          </div>\n        </div>\n        <Paginate\n          css     = {this.state.pagination_css}\n          onClick = {this._paginate.bind(this)}\n        />\n\n      </section>\n    );\n  }\n\n  _setCss(){\n    return `panel ${this.props.title.toLowerCase()}`;\n  }\n\n  _onChange(){\n    let columns = ColumnsStore.getKeyAndTitle();\n    this.setState({\n      columns: columns\n    });\n  }\n\n  _onLoaded(){\n    let sessions, st, fn;\n    st = this.props.time.st;\n    fn = this.props.time.fn;\n    sessions = SessionsStore._getDate().data;\n    sessions = sessions.getTimePeriod(st, fn);\n    this.pagination[1].hidden = (sessions.size <= 100);\n    this.setState({\n      paginate: 100\n      , pagination_css: this.getClasses(this.pagination)\n      , data: sessions\n    });\n  }\n\n  _paginate(e){\n    e.preventDefault();\n    let pag = this.state.paginate + 10;\n    if (pag > this.state.data.size){\n      this.pagination  = this.toggleCss(this.pagination);\n    }\n\n    this.setState({\n      paginate: pag\n      , pagination_css: this.getClasses(this.pagination)\n    });\n  }\n}\n\nObject.assign(PeriodSessions.prototype, cssMixins);\nObject.assign(PeriodSessions.prototype, textMixins);\n\nmodule.exports = PeriodSessions;\n"]}