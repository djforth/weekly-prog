{"version":3,"sources":["../../../src/components/sessions/period_sessions.js"],"names":[],"mappings":"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","file":"period_sessions.js","sourcesContent":["// Libraries\nconst React = require('react');\n\nconst DataHead     = require('./data_head')\n    , DataExpander = require('./data_expander_item')\n    , NoSessions   = require('./stateless/no_sessions')\n    , Paginate     = require('./stateless/paginate')\n    , PeriodHead   = require('./stateless/period_head');\n\n// Flux\nconst ColumnsStore   = require('../../stores/columns_store')\n    , SessionsStore = require('../../stores/sessions_store');\n\n// Mixins\nconst cssMixins  = require('morse-react-mixins').css_mixins\n    , textMixins = require('morse-react-mixins').text_mixins;\n\nclass PeriodSessions extends React.Component{\n  constructor(props){\n    super(props);\n    let st, fn, sessions, hidden;\n    st = this.props.time.st;\n    fn = this.props.time.fn;\n    sessions = this.props.sessions.getTimePeriod(st, fn);\n\n    hidden = (sessions.size <= 100);\n    this.pagination = ['weekly-pagination', {hidden: hidden}];\n\n    this.state = {\n      columns: []\n      , data: sessions\n      , keys: []\n      , visible: []\n      , device: 'desktop'\n      , paginate: 4\n      , pagination_css: this.getClasses(this.pagination)\n    };\n  }\n\n  componentWillMount(){\n    this.setState({columns: ColumnsStore.getVisible()});\n  }\n\n  componentDidMount(){\n    // Data Changers\n    ColumnsStore.addChangeListener('change', this._onChange.bind(this));\n    SessionsStore.addChangeListener('changing_date', this._onLoaded.bind(this));\n    SessionsStore.addChangeListener('fetched', this._onLoaded.bind(this));\n  }\n\n  componentWillUnmount(){\n    SessionsStore.removeChangeListener('changing_date', this._onLoaded);\n    SessionsStore.removeChangeListener('fetched', this._onLoaded);\n    ColumnsStore.removeChangeListener('change', this._onChange);\n  }\n\n  _renderData(){\n    if (this.state.data && this.state.data.size > 0){\n      return this._renderSessions();\n    }\n    return this._renderNoSessions();\n  }\n\n  _renderNoSessions(){\n    return (\n        <NoSessions\n          no_session={this.props.no_sessions}\n          title={this.props.title} />);\n  }\n\n  _renderSessions(){\n    let data = this.state.data.slice(0, this.state.paginate);\n     // console.log(data)\n    return data.map((d)=>{\n      return (\n        <DataExpander\n          css  = {this.props.css}\n          data = {d}\n          key  = {this.createId('session', d.get('id'))} />\n        );\n    });\n  }\n\n  render(){\n    return (\n      <section key=\"items\" className={this._setCss()}>\n        <PeriodHead title={this.props.title} />\n        <div className=\"table\">\n          <DataHead columns={this.state.columns} css={this.props.css}  />\n          <div className=\"tbody\">\n            {this._renderData(this.state.paginate)}\n          </div>\n        </div>\n        <Paginate\n          css     = {this.state.pagination_css}\n          onClick = {this._paginate.bind(this)}\n        />\n\n      </section>\n    );\n  }\n\n  _setCss(){\n    return `panel ${this.props.title.toLowerCase()}`;\n  }\n\n  _onChange(){\n    let columns = ColumnsStore.getKeyAndTitle();\n    this.setState({\n      columns: columns\n    });\n  }\n\n  _onLoaded(){\n    let sessions, st, fn;\n    st = this.props.time.st;\n    fn = this.props.time.fn;\n    sessions = SessionsStore._getDate().data;\n    sessions = sessions.getTimePeriod(st, fn);\n    this.pagination[1].hidden = (sessions.size <= 100);\n    this.setState({\n      paginate: 100\n      , pagination_css: this.getClasses(this.pagination)\n      , data: sessions\n    });\n  }\n\n  _paginate(e){\n    e.preventDefault();\n    let pag = this.state.paginate + 10;\n    if (pag > this.state.data.size){\n      this.pagination  = this.toggleCss(this.pagination);\n    }\n\n    this.setState({\n      paginate: pag\n      , pagination_css: this.getClasses(this.pagination)\n    });\n  }\n}\n\nObject.assign(PeriodSessions.prototype, cssMixins);\nObject.assign(PeriodSessions.prototype, textMixins);\n\nmodule.exports = PeriodSessions;\n"]}