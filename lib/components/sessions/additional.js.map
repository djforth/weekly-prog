{"version":3,"sources":["../../../src/components/sessions/additional.js"],"names":[],"mappings":";;;;;;;;;;;AACA,IAAM,QAAQ,QAAQ,OAAR,CAAd;AACA,IAAI,IAAI,QAAQ,aAAR,CAAR;AACA,EAAE,QAAF,GAAa,QAAQ,iBAAR,CAAb;AACA,EAAE,MAAF,GAAW,QAAQ,eAAR,CAAX;;AAEA,IAAM,eAAiB,QAAQ,4BAAR,CAAvB;;;AAGA,IAAM,YAAa,QAAQ,oBAAR,EAA8B,UAAjD;AACA,IAAM,aAAc,QAAQ,oBAAR,EAA8B,WAAlD;;AAEA,IAAM,oBAAqB,QAAQ,gCAAR,CAA3B;IACM,UAAc,QAAQ,sBAAR,CADpB;IAEM,cAAc,QAAQ,yBAAR,CAFpB;IAGM,WAAc,QAAQ,sBAAR,CAHpB;;IAKM,U;YAAA,U;;AACJ,WADI,UACJ,CAAY,KAAZ,EAAkB;AAAA,0BADd,UACc;;AAAA,uEADd,UACc,aACV,KADU;;AAEhB,UAAK,KAAL,GAAa,EAAC,SAAS,aAAa,WAAb,EAAV,EAAb;AAFgB;AAGjB;;eAJG,U;;yCAMgB;AAClB,WAAK,OAAL,GAAe,IAAf;AACA,WAAK,QAAL,CAAc,EAAC,SAAS,aAAa,WAAb,EAAV,EAAd;AACA,mBAAa,iBAAb,CAA+B,QAA/B,EAAyC,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAzC;AACD;;;2CAEqB;AACpB,WAAK,OAAL,GAAe,KAAf;AACA,mBAAa,oBAAb,CAAkC,QAAlC,EAA4C,KAAK,SAAjD;AACD;;;gCAEU;AACT,UAAI,KAAK,OAAT,EAAiB;AACf,aAAK,QAAL,CAAc;AACZ,mBAAS,aAAa,WAAb;AADG,SAAd;AAGD;AACF;;;iCAEY,I,EAAK;AAChB,aAAO,KAAK,GAAL,CAAS,SAAT,KAAuB,KAAK,GAAL,CAAS,SAAT,EAAoB,GAApB,CAAwB,MAAxB,CAA9B;AACD;;;qCAEe;AACd,UAAI,YAAJ;UAAS,aAAT;UAAe,aAAf;UAAqB,YAArB;UAA0B,eAA1B;;AAEA,YAAM,EAAE,MAAF,CAAS,KAAK,KAAL,CAAW,OAApB,EAA6B,EAAC,KAAK,SAAN,EAA7B,CAAN;AACA,UAAI,EAAE,OAAF,CAAU,GAAV,CAAJ,EAAoB,OAAO,EAAP;;AAEpB,aAAO,KAAK,KAAL,CAAW,IAAlB;AACA,eAAS,KAAK,GAAL,CAAS,aAAT,CAAT;AACA,aAAQ,KAAK,YAAL,CAAkB,IAAlB,CAAD,GAA4B,KAAK,GAAL,CAAS,SAAT,EAAoB,GAApB,CAAwB,MAAxB,CAA5B,GAA8D,IAArE;AACA,YAAM,KAAK,QAAL,CAAc,IAAI,GAAlB,EAAuB,KAAK,GAAL,CAAS,IAAT,CAAvB,CAAN;;AAEA,aAAQ,oBAAC,OAAD;AACN,gBAAU,MADJ;AAEN,cAAU,IAFJ;AAGN,aAAU;AAHJ,QAAR;AAKD;;;kCAEY;AAAA;;AACX,UAAI,aAAJ;UAAU,cAAV;AACA,aAAO,KAAK,KAAL,CAAW,IAAlB;;AAEA,cAAQ,EAAE,MAAF,CAAS,KAAK,KAAL,CAAW,OAApB,EAA6B,EAAC,KAAK,aAAN,EAA7B,CAAR;AACA,cAAS,EAAE,MAAF,CAAS,KAAT,EAAgB,EAAC,KAAK,SAAN,EAAhB,CAAT;AACA,UAAI,QAAQ,KAAZ,EAAkB;AAChB,YAAI,KAAK,EAAE,GAAF,CAAM,KAAN,EAAa,UAAC,GAAD,EAAO;AAC3B,cAAI,MAAM,OAAK,QAAL,CAAc,IAAI,GAAlB,EAAuB,OAAK,KAAL,CAAW,IAAX,CAAgB,GAAhB,CAAoB,IAApB,CAAvB,CAAV;AACA,iBACE;AAAA;YAAA,EAAI,WAAU,0BAAd;AACE,mBAAQ,GADV;YAEE;AAAA;cAAA;cAAS,IAAI,KAAb;cAAA;AAAA,aAFF;YAGE,oBAAC,iBAAD;AACE,mBAAQ,GADV;AAEE,oBAAQ;AAFV;AAHF,WADF;AAUD,SAZQ,CAAT;;AAcA,eAAO,EAAP;AACD;;AAED,aAAO,EAAP;AACD;;;6BAEO;AACN,aAAQ;AAAA;QAAA,EAAK,2BAAyB,KAAK,KAAL,CAAW,MAAzC;QACH;AAAA;UAAA,EAAI,WAAW,KAAK,KAAL,CAAW,IAA1B;UACE,KAAK,WAAL;AADF,SADG;QAIJ;AAAA;UAAA,EAAK,WAAU,aAAf;UACE,oBAAC,QAAD,IAAU,SAAS,KAAK,KAAL,CAAW,IAAX,CAAgB,GAAhB,CAAoB,aAApB,CAAnB;AADF,SAJI;QAOH,KAAK,cAAL;AAPG,OAAR;AASD;;;SApFG,U;EAAmB,MAAM,S;;AAuF/B,OAAO,MAAP,CAAc,WAAW,SAAzB,EAAoC,SAApC;AACA,OAAO,MAAP,CAAc,WAAW,SAAzB,EAAoC,UAApC;;AAEA,OAAO,OAAP,GAAiB,UAAjB","file":"additional.js","sourcesContent":["// Libraries\nconst React = require('react');\nvar _ = require('lodash/core');\n_.includes = require('lodash/includes');\n_.reject = require('lodash/reject');\n\nconst ColumnsStore   = require('../../stores/columns_store');\n\n// Mixins\nconst cssMixins  = require('morse-react-mixins').css_mixins;\nconst textMixins  = require('morse-react-mixins').text_mixins;\n\nconst AdditionalContent  = require('./stateless/additional_content')\n    , BookBtn     = require('./stateless/book_btn')\n    , Description = require('./stateless/description')\n    , RichText    = require('./stateless/richtext');\n\nclass Additional extends React.Component{\n  constructor(props){\n    super(props);\n    this.state = {columns: ColumnsStore.getShowable()};\n  }\n\n  componentWillMount(){\n    this.mounted = true;\n    this.setState({columns: ColumnsStore.getShowable()});\n    ColumnsStore.addChangeListener('change', this._onChange.bind(this));\n  }\n\n  componentWillUnmount(){\n    this.mounted = false;\n    ColumnsStore.removeChangeListener('change', this._onChange);\n  }\n\n  _onChange(){\n    if (this.mounted){\n      this.setState({\n        columns: ColumnsStore.getShowable()\n      });\n    }\n  }\n\n  _checkButton(item){\n    return item.has('buttons') && item.get('buttons').has('book');\n  }\n\n  _renderActions(){\n    let col, link, item, key, places;\n\n    col = _.filter(this.state.columns, {key: 'actions'});\n    if (_.isEmpty(col)) return '';\n\n    item = this.props.data;\n    places = item.get('places_left');\n    link = (this._checkButton(item)) ? item.get('buttons').get('book') : null;\n    key = this.createId(col.key, item.get('id'));\n\n    return (<BookBtn\n      places = {places}\n      link   = {link}\n      key    = {key}\n    />);\n  }\n\n  _renderList(){\n    let data, extra;\n    data = this.props.data;\n\n    extra = _.reject(this.state.columns, {key: 'description'});\n    extra  = _.reject(extra, {key: 'actions'});\n    if (data && extra){\n      let li = _.map(extra, (col)=>{\n        let key = this.createId(col.key, this.props.data.get('id'));\n        return (\n          <li className=\"list-group-item col-md-4\"\n            key  = {key}>\n            <strong>{col.title}: </strong>\n            <AdditionalContent\n              col  = {col}\n              item = {data}\n            />\n          </li>\n        );\n      });\n\n      return li;\n    }\n\n    return '';\n  }\n\n  render(){\n    return (<div className={`additional ${this.props.active}`}>\n         <ul className={this.props.info}>\n          {this._renderList()}\n        </ul>\n        <div className=\"description\">\n          <RichText content={this.props.data.get('description')} />\n        </div>\n        {this._renderActions()}\n      </div>);\n  }\n}\n\nObject.assign(Additional.prototype, cssMixins);\nObject.assign(Additional.prototype, textMixins);\n\nmodule.exports = Additional;\n\n"]}