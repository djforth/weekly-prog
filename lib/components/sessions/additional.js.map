{"version":3,"sources":["../../../src/components/sessions/additional.js"],"names":[],"mappings":"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","file":"additional.js","sourcesContent":["// Libraries\nconst React = require('react');\nvar _ = require('lodash/core');\n_.includes = require('lodash/includes');\n_.reject = require('lodash/reject');\n\nconst ColumnsStore   = require('../../stores/columns_store');\n\n// Mixins\nconst cssMixins  = require('morse-react-mixins').css_mixins;\nconst textMixins  = require('morse-react-mixins').text_mixins;\n\nconst AdditionalContent  = require('./stateless/additional_content')\n    , BookBtn     = require('./stateless/book_btn')\n    , Description = require('./stateless/description')\n    , RichText    = require('./stateless/richtext');\n\nclass Additional extends React.Component{\n  constructor(props){\n    super(props);\n    this.state = {columns: ColumnsStore.getShowable()};\n  }\n\n  componentWillMount(){\n    this.mounted = true;\n    this.setState({columns: ColumnsStore.getShowable()});\n    ColumnsStore.addChangeListener('change', this._onChange.bind(this));\n  }\n\n  componentWillUnmount(){\n    this.mounted = false;\n    ColumnsStore.removeChangeListener('change', this._onChange);\n  }\n\n  _onChange(){\n    if (this.mounted){\n      this.setState({\n        columns: ColumnsStore.getShowable()\n      });\n    }\n  }\n\n  _checkButton(item){\n    return item.has('buttons') && item.get('buttons').has('book');\n  }\n\n  _renderActions(){\n    let col, link, item, key, places;\n\n    col = _.filter(this.state.columns, {key: 'actions'});\n    if (_.isEmpty(col)) return '';\n\n    item = this.props.data;\n    places = item.get('places_left');\n    link = (this._checkButton(item)) ? item.get('buttons').get('book') : null;\n    key = this.createId(col.key, item.get('id'));\n\n    return (<BookBtn\n      places = {places}\n      link   = {link}\n      key    = {key}\n    />);\n  }\n\n  _renderList(){\n    let data, extra;\n    data = this.props.data;\n\n    extra = _.reject(this.state.columns, {key: 'description'});\n    extra  = _.reject(extra, {key: 'actions'});\n    if (data && extra){\n      let li = _.map(extra, (col)=>{\n        let key = this.createId(col.key, this.props.data.get('id'));\n        return (\n          <li className=\"list-group-item col-md-4\"\n            key  = {key}>\n            <strong>{col.title}: </strong>\n            <AdditionalContent\n              col  = {col}\n              item = {data}\n            />\n          </li>\n        );\n      });\n\n      return li;\n    }\n\n    return '';\n  }\n\n  render(){\n    return (<div className={`additional ${this.props.active}`}>\n         <ul className={this.props.info}>\n          {this._renderList()}\n        </ul>\n        <div className=\"description\">\n          <RichText content={this.props.data.get('description')} />\n        </div>\n        {this._renderActions()}\n      </div>);\n  }\n}\n\nObject.assign(Additional.prototype, cssMixins);\nObject.assign(Additional.prototype, textMixins);\n\nmodule.exports = Additional;\n\n"]}